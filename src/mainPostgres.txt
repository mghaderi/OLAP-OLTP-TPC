//
//
//
//basic codes:

docker run -it --shm-size=1gb -v /mnt/storage/mohamad/postgres/data:/var/lib/postgresql/data -v /data:/data:ro --name mohamad_postgres -e POSTGRES_PASSWORD=root -e POSTGRES_USER=root postgres    //make container with docker
docker start mohamad_postgres  // starting container
docker exec -it mohamad_postgres bash //execute container
psql //go inside of psql
create database mdb OWNER root ENCODING UTF8 // create database
//make tables
DROP TABLE IF EXISTS PART CASCADE;
CREATE TABLE PART (

	P_PARTKEY		SERIAL PRIMARY KEY,
	P_NAME			VARCHAR(55),
	P_MFGR			CHAR(25),
	P_BRAND			CHAR(10),
	P_TYPE			VARCHAR(25),
	P_SIZE			INTEGER,
	P_CONTAINER		CHAR(10),
	P_RETAILPRICE	DECIMAL,
	P_COMMENT		VARCHAR(23)
);

DROP TABLE IF EXISTS SUPPLIER CASCADE;
CREATE TABLE SUPPLIER (
	S_SUPPKEY		SERIAL PRIMARY KEY,
	S_NAME			CHAR(25),
	S_ADDRESS		VARCHAR(40),
	S_NATIONKEY		BIGINT NOT NULL, -- references N_NATIONKEY
	S_PHONE			CHAR(15),
	S_ACCTBAL		DECIMAL,
	S_COMMENT		VARCHAR(101)
);

DROP TABLE IF EXISTS PARTSUPP CASCADE;
CREATE TABLE PARTSUPP (
	PS_PARTKEY		BIGINT NOT NULL, -- references P_PARTKEY
	PS_SUPPKEY		BIGINT NOT NULL, -- references S_SUPPKEY
	PS_AVAILQTY		INTEGER,
	PS_SUPPLYCOST	DECIMAL,
	PS_COMMENT		VARCHAR(199),
	PRIMARY KEY (PS_PARTKEY, PS_SUPPKEY)
);

DROP TABLE IF EXISTS CUSTOMER CASCADE;
CREATE TABLE CUSTOMER (
	C_CUSTKEY		SERIAL PRIMARY KEY,
	C_NAME			VARCHAR(25),
	C_ADDRESS		VARCHAR(40),
	C_NATIONKEY		BIGINT NOT NULL, -- references N_NATIONKEY
	C_PHONE			CHAR(15),
	C_ACCTBAL		DECIMAL,
	C_MKTSEGMENT	CHAR(10),
	C_COMMENT		VARCHAR(117)
);

DROP TABLE IF EXISTS ORDERS CASCADE;
CREATE TABLE ORDERS (
	O_ORDERKEY		SERIAL PRIMARY KEY,
	O_CUSTKEY		BIGINT NOT NULL, -- references C_CUSTKEY
	O_ORDERSTATUS	CHAR(1),
	O_TOTALPRICE	DECIMAL,
	O_ORDERDATE		DATE,
	O_ORDERPRIORITY	CHAR(15),
	O_CLERK			CHAR(15),
	O_SHIPPRIORITY	INTEGER,
	O_COMMENT		VARCHAR(79)
);

DROP TABLE IF EXISTS LINEITEM CASCADE;
CREATE TABLE LINEITEM (
	L_ORDERKEY		BIGINT NOT NULL, -- references O_ORDERKEY
	L_PARTKEY		BIGINT NOT NULL, -- references P_PARTKEY (compound fk to PARTSUPP)
	L_SUPPKEY		BIGINT NOT NULL, -- references S_SUPPKEY (compound fk to PARTSUPP)
	L_LINENUMBER	INTEGER,
	L_QUANTITY		DECIMAL,
	L_EXTENDEDPRICE	DECIMAL,
	L_DISCOUNT		DECIMAL,
	L_TAX			DECIMAL,
	L_RETURNFLAG	CHAR(1),
	L_LINESTATUS	CHAR(1),
	L_SHIPDATE		DATE,
	L_COMMITDATE	DATE,
	L_RECEIPTDATE	DATE,
	L_SHIPINSTRUCT	CHAR(25),
	L_SHIPMODE		CHAR(10),
	L_COMMENT		VARCHAR(44),
	PRIMARY KEY (L_ORDERKEY, L_LINENUMBER)
);

DROP TABLE IF EXISTS NATION CASCADE;
CREATE TABLE NATION (
	N_NATIONKEY		SERIAL PRIMARY KEY,
	N_NAME			CHAR(25),
	N_REGIONKEY		BIGINT NOT NULL,  -- references R_REGIONKEY
	N_COMMENT		VARCHAR(152)
);

DROP TABLE IF EXISTS REGION CASCADE;
CREATE TABLE REGION (
	R_REGIONKEY	SERIAL PRIMARY KEY,
	R_NAME		CHAR(25),
	R_COMMENT	VARCHAR(152)
);
alter table nation add column temp char(1); // change tables to be able reading .tbl files
BEGIN; \COPY nation FROM /data/OLAP_Benchmark_data/nation.tbl with delimiter '|'; COMMIT; //loading tables
\o 1.txt //a place to save analyze of query
explain analyze select * from nation; //run query output analyze of query




//
//
//
//query1:
select
	l_returnflag,
	l_linestatus,
	sum(l_quantity) as sum_qty,
	sum(l_extendedprice) as sum_base_price,
	sum(l_extendedprice * (1 - l_discount)) as sum_disc_price,
	sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge,
	avg(l_quantity) as avg_qty,
	avg(l_extendedprice) as avg_price,
	avg(l_discount) as avg_disc,
	count(*) as count_order
from
	lineitem
where
	l_shipdate <= date '1998-12-01' - interval '104' day
group by
	l_returnflag,
	l_linestatus
order by
	l_returnflag,
	l_linestatus
LIMIT 1;



//query2:

select
	s_acctbal,
	s_name,
	n_name,
	p_partkey,
	p_mfgr,
	s_address,
	s_phone,
	s_comment
from
	part,
	supplier,
	partsupp,
	nation,
	region
where
	p_partkey = ps_partkey
	and s_suppkey = ps_suppkey
	and p_size = 41
	and p_type like '%NICKEL'
	and s_nationkey = n_nationkey
	and n_regionkey = r_regionkey
	and r_name = 'EUROPE'
	and ps_supplycost = (
		select
			min(ps_supplycost)
		from
			partsupp,
			supplier,
			nation,
			region
		where
			p_partkey = ps_partkey
			and s_suppkey = ps_suppkey
			and s_nationkey = n_nationkey
			and n_regionkey = r_regionkey
			and r_name = 'EUROPE'
	)
order by
	s_acctbal desc,
	n_name,
	s_name,
	p_partkey
LIMIT 100;


//query3:

select
	l_orderkey,
	sum(l_extendedprice * (1 - l_discount)) as revenue,
	o_orderdate,
	o_shippriority
from
	customer,
	orders,
	lineitem
where
	c_mktsegment = 'MACHINERY'
	and c_custkey = o_custkey
	and l_orderkey = o_orderkey
	and o_orderdate < date '1995-03-25'
	and l_shipdate > date '1995-03-25'
group by
	l_orderkey,
	o_orderdate,
	o_shippriority
order by
	revenue desc,
	o_orderdate
LIMIT 10;

//query4:

select
	o_orderpriority,
	count(*) as order_count
from
	orders
where
	o_orderdate >= date '1996-11-01'
	and o_orderdate < date '1996-11-01' + interval '3' month
	and exists (
		select
			*
		from
			lineitem
		where
			l_orderkey = o_orderkey
			and l_commitdate < l_receiptdate
	)
group by
	o_orderpriority
order by
	o_orderpriority
LIMIT 1;


//query5:

select
	n_name,
	sum(l_extendedprice * (1 - l_discount)) as revenue
from
	customer,
	orders,
	lineitem,
	supplier,
	nation,
	region
where
	c_custkey = o_custkey
	and l_orderkey = o_orderkey
	and l_suppkey = s_suppkey
	and c_nationkey = s_nationkey
	and s_nationkey = n_nationkey
	and n_regionkey = r_regionkey
	and r_name = 'AFRICA'
	and o_orderdate >= date '1996-01-01'
	and o_orderdate < date '1996-01-01' + interval '1' year
group by
	n_name
order by
	revenue desc
LIMIT 1;


//query6:

select
	sum(l_extendedprice * l_discount) as revenue
from
	lineitem
where
	l_shipdate >= date '1996-01-01'
	and l_shipdate < date '1996-01-01' + interval '1' year
	and l_discount between 0.03 - 0.01 and 0.03 + 0.01
	and l_quantity < 24
LIMIT 1;


//query7:

select
	supp_nation,
	cust_nation,
	l_year,
	sum(volume) as revenue
from
	(
		select
			n1.n_name as supp_nation,
			n2.n_name as cust_nation,
			extract(year from l_shipdate) as l_year,
			l_extendedprice * (1 - l_discount) as volume
		from
			supplier,
			lineitem,
			orders,
			customer,
			nation n1,
			nation n2
		where
			s_suppkey = l_suppkey
			and o_orderkey = l_orderkey
			and c_custkey = o_custkey
			and s_nationkey = n1.n_nationkey
			and c_nationkey = n2.n_nationkey
			and (
				(n1.n_name = 'ETHIOPIA' and n2.n_name = 'JAPAN')
				or (n1.n_name = 'JAPAN' and n2.n_name = 'ETHIOPIA')
			)
			and l_shipdate between date '1995-01-01' and date '1996-12-31'
	) as shipping
group by
	supp_nation,
	cust_nation,
	l_year
order by
	supp_nation,
	cust_nation,
	l_year
LIMIT 1;

//query8:

select
	o_year,
	sum(case
		when nation = 'JAPAN' then volume
		else 0
	end) / sum(volume) as mkt_share
from
	(
		select
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) as volume,
			n2.n_name as nation
		from
			part,
			supplier,
			lineitem,
			orders,
			customer,
			nation n1,
			nation n2,
			region
		where
			p_partkey = l_partkey
			and s_suppkey = l_suppkey
			and l_orderkey = o_orderkey
			and o_custkey = c_custkey
			and c_nationkey = n1.n_nationkey
			and n1.n_regionkey = r_regionkey
			and r_name = 'ASIA'
			and s_nationkey = n2.n_nationkey
			and o_orderdate between date '1995-01-01' and date '1996-12-31'
			and p_type = 'LARGE BRUSHED NICKEL'
	) as all_nations
group by
	o_year
order by
	o_year
LIMIT 1;

//query9:

select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%orchid%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc
LIMIT 1;

//query10:

select
	c_custkey,
	c_name,
	sum(l_extendedprice * (1 - l_discount)) as revenue,
	c_acctbal,
	n_name,
	c_address,
	c_phone,
	c_comment
from
	customer,
	orders,
	lineitem,
	nation
where
	c_custkey = o_custkey
	and l_orderkey = o_orderkey
	and o_orderdate >= date '1994-11-01'
	and o_orderdate < date '1994-11-01' + interval '3' month
	and l_returnflag = 'R'
	and c_nationkey = n_nationkey
group by
	c_custkey,
	c_name,
	c_acctbal,
	c_phone,
	n_name,
	c_address,
	c_comment
order by
	revenue desc
LIMIT 20;

//query11:

select
	ps_partkey,
	sum(ps_supplycost * ps_availqty) as value
from
	partsupp,
	supplier,
	nation
where
	ps_suppkey = s_suppkey
	and s_nationkey = n_nationkey
	and n_name = 'ARGENTINA'
group by
	ps_partkey having
		sum(ps_supplycost * ps_availqty) > (
			select
				sum(ps_supplycost * ps_availqty) * 0.0001000000
			from
				partsupp,
				supplier,
				nation
			where
				ps_suppkey = s_suppkey
				and s_nationkey = n_nationkey
				and n_name = 'ARGENTINA'
		)
order by
	value desc
LIMIT 1;

//query12:

select
	l_shipmode,
	sum(case
		when o_orderpriority = '1-URGENT'
			or o_orderpriority = '2-HIGH'
			then 1
		else 0
	end) as high_line_count,
	sum(case
		when o_orderpriority <> '1-URGENT'
			and o_orderpriority <> '2-HIGH'
			then 1
		else 0
	end) as low_line_count
from
	orders,
	lineitem
where
	o_orderkey = l_orderkey
	and l_shipmode in ('TRUCK', 'RAIL')
	and l_commitdate < l_receiptdate
	and l_shipdate < l_commitdate
	and l_receiptdate >= date '1994-01-01'
	and l_receiptdate < date '1994-01-01' + interval '1' year
group by
	l_shipmode
order by
	l_shipmode
LIMIT 1;

//query13:

select
	c_count,
	count(*) as custdist
from
	(
		select
			c_custkey,
			count(o_orderkey)
		from
			customer left outer join orders on
				c_custkey = o_custkey
				and o_comment not like '%pending%packages%'
		group by
			c_custkey
	) as c_orders (c_custkey, c_count)
group by
	c_count
order by
	custdist desc,
	c_count desc
LIMIT 1;

//query14:

select
	100.00 * sum(case
		when p_type like 'PROMO%'
			then l_extendedprice * (1 - l_discount)
		else 0
	end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue
from
	lineitem,
	part
where
	l_partkey = p_partkey
	and l_shipdate >= date '1994-03-01'
	and l_shipdate < date '1994-03-01' + interval '1' month
LIMIT 1;

//query15:
create view revenue0 (supplier_no, total_revenue) as
	select
		l_suppkey,
		sum(l_extendedprice * (1 - l_discount))
	from
		lineitem
	where
		l_shipdate >= date '1997-05-01'
		and l_shipdate < date '1997-05-01' + interval '3' month
	group by
		l_suppkey;


select
	s_suppkey,
	s_name,
	s_address,
	s_phone,
	total_revenue
from
	supplier,
	revenue0
where
	s_suppkey = supplier_no
	and total_revenue = (
		select
			max(total_revenue)
		from
			revenue0
	)
order by
	s_suppkey
LIMIT 1;

drop view revenue0;

//query16:

select
	p_brand,
	p_type,
	p_size,
	count(distinct ps_suppkey) as supplier_cnt
from
	partsupp,
	part
where
	p_partkey = ps_partkey
	and p_brand <> 'Brand#31'
	and p_type not like 'LARGE PLATED%'
	and p_size in (47, 31, 18, 19, 48, 7, 39, 22)
	and ps_suppkey not in (
		select
			s_suppkey
		from
			supplier
		where
			s_comment like '%Customer%Complaints%'
	)
group by
	p_brand,
	p_type,
	p_size
order by
	supplier_cnt desc,
	p_brand,
	p_type,
	p_size
LIMIT 1;

//query17:

select
	sum(l_extendedprice) / 7.0 as avg_yearly
from
	lineitem,
	part,
	(SELECT l_partkey AS agg_partkey, 0.2 * avg(l_quantity) AS avg_quantity FROM lineitem GROUP BY l_partkey) part_agg
where
	p_partkey = l_partkey
	and agg_partkey = l_partkey
	and p_brand = 'Brand#13'
	and p_container = 'WRAP PKG'
	and l_quantity < avg_quantity
LIMIT 1;


//query18:

select
	c_name,
	c_custkey,
	o_orderkey,
	o_orderdate,
	o_totalprice,
	sum(l_quantity)
from
	customer,
	orders,
	lineitem
where
	o_orderkey in (
		select
			l_orderkey
		from
			lineitem
		group by
			l_orderkey having
				sum(l_quantity) > 314
	)
	and c_custkey = o_custkey
	and o_orderkey = l_orderkey
group by
	c_name,
	c_custkey,
	o_orderkey,
	o_orderdate,
	o_totalprice
order by
	o_totalprice desc,
	o_orderdate
LIMIT 100;

//query19:

select
	sum(l_extendedprice* (1 - l_discount)) as revenue
from
	lineitem,
	part
where
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#54'
		and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG')
		and l_quantity >= 8 and l_quantity <= 8 + 10
		and p_size between 1 and 5
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	)
	or
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#22'
		and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK')
		and l_quantity >= 13 and l_quantity <= 13 + 10
		and p_size between 1 and 10
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	)
	or
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#51'
		and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG')
		and l_quantity >= 22 and l_quantity <= 22 + 10
		and p_size between 1 and 15
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	)
LIMIT 1;

//query20:

select
	s_name,
	s_address
from
	supplier,
	nation
where
	s_suppkey in (
		select
			ps_suppkey
		from
			partsupp,
			(
				select
					l_partkey agg_partkey,
					l_suppkey agg_suppkey,
					0.5 * sum(l_quantity) AS agg_quantity
				from
					lineitem
				where
					l_shipdate >= date '1994-01-01'
					and l_shipdate < date '1994-01-01' + interval '1' year
				group by
					l_partkey,
					l_suppkey
			) agg_lineitem
		where
			agg_partkey = ps_partkey
			and agg_suppkey = ps_suppkey
			and ps_partkey in (
				select
					p_partkey
				from
					part
				where
					p_name like 'navajo%'
			)
			and ps_availqty > agg_quantity
	)
	and s_nationkey = n_nationkey
	and n_name = 'INDIA'
order by
	s_name
LIMIT 1;


//query21:

select
	s_name,
	count(*) as numwait
from
	supplier,
	lineitem l1,
	orders,
	nation
where
	s_suppkey = l1.l_suppkey
	and o_orderkey = l1.l_orderkey
	and o_orderstatus = 'F'
	and l1.l_receiptdate > l1.l_commitdate
	and exists (
		select
			*
		from
			lineitem l2
		where
			l2.l_orderkey = l1.l_orderkey
			and l2.l_suppkey <> l1.l_suppkey
	)
	and not exists (
		select
			*
		from
			lineitem l3
		where
			l3.l_orderkey = l1.l_orderkey
			and l3.l_suppkey <> l1.l_suppkey
			and l3.l_receiptdate > l3.l_commitdate
	)
	and s_nationkey = n_nationkey
	and n_name = 'INDIA'
group by
	s_name
order by
	numwait desc,
	s_name
LIMIT 100;

//query22:

select
	cntrycode,
	count(*) as numcust,
	sum(c_acctbal) as totacctbal
from
	(
		select
			substring(c_phone from 1 for 2) as cntrycode,
			c_acctbal
		from
			customer
		where
			substring(c_phone from 1 for 2) in
				('28', '43', '22', '39', '31', '30', '41')
			and c_acctbal > (
				select
					avg(c_acctbal)
				from
					customer
				where
					c_acctbal > 0.00
					and substring(c_phone from 1 for 2) in
						('28', '43', '22', '39', '31', '30', '41')
			)
			and not exists (
				select
					*
				from
					orders
				where
					o_custkey = c_custkey
			)
	) as custsale
group by
	cntrycode
order by
	cntrycode
LIMIT 1;

//
//
//
//results of queries:
query1:
BEGIN
                                                                              QUERY PLAN                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=25227686.75..25227687.09 rows=1 width=236) (actual time=1849274.577..1849280.445 rows=1 loops=1)
   ->  Finalize GroupAggregate  (cost=25227686.75..25227688.82 rows=6 width=236) (actual time=1849274.575..1849274.575 rows=1 loops=1)
         Group Key: l_returnflag, l_linestatus
         ->  Gather Merge  (cost=25227686.75..25227688.15 rows=12 width=236) (actual time=1849274.451..1849280.321 rows=4 loops=1)
               Workers Planned: 2
               Workers Launched: 2
               ->  Sort  (cost=25226686.72..25226686.74 rows=6 width=236) (actual time=1849265.945..1849265.947 rows=3 loops=3)
                     Sort Key: l_returnflag, l_linestatus
                     Sort Method: quicksort  Memory: 27kB
                     Worker 0:  Sort Method: quicksort  Memory: 27kB
                     Worker 1:  Sort Method: quicksort  Memory: 27kB
                     ->  Partial HashAggregate  (cost=25226686.48..25226686.64 rows=6 width=236) (actual time=1849265.861..1849265.880 rows=4 loops=3)
                           Group Key: l_returnflag, l_linestatus
                           ->  Parallel Seq Scan on lineitem  (cost=0.00..15413080.00 rows=245340162 width=25) (actual time=0.144..1477798.467 rows=196261372 loops=3)
                                 Filter: (l_shipdate <= '1998-08-19 00:00:00'::timestamp without time zone)
                                 Rows Removed by Filter: 3751262
 Planning Time: 1.701 ms
 Execution Time: 1849280.689 ms
(18 rows)

COMMIT
query2:
BEGIN
                                                                                     QUERY PLAN                                                                          
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=6392819.14..6392819.15 rows=1 width=270) (actual time=4047842.571..4048348.204 rows=100 loops=1)
   ->  Sort  (cost=6392819.14..6392819.15 rows=1 width=270) (actual time=4047842.569..4047842.580 rows=100 loops=1)
         Sort Key: supplier.s_acctbal DESC, nation.n_name, supplier.s_name, part.p_partkey
         Sort Method: top-N heapsort  Memory: 70kB
         ->  Merge Join  (cost=2530341.91..6392819.13 rows=1 width=270) (actual time=395472.253..4047759.203 rows=47481 loops=1)
               Merge Cond: (part.p_partkey = partsupp.ps_partkey)
               Join Filter: (partsupp.ps_supplycost = (SubPlan 1))
               Rows Removed by Join Filter: 16896
               ->  Gather Merge  (cost=1000.46..868856.35 rows=70471 width=30) (actual time=26.232..1674.613 rows=80157 loops=1)
                     Workers Planned: 2
                     Workers Launched: 2
                     ->  Parallel Index Scan using part_pkey on part  (cost=0.44..859722.22 rows=29363 width=30) (actual time=6.792..131964.537 rows=26719 loops=3)
                           Filter: (((p_type)::text ~~ '%NICKEL'::text) AND (p_size = 41))
                           Rows Removed by Filter: 6639948
               ->  Materialize  (cost=2529329.13..2531606.49 rows=455473 width=254) (actual time=389733.235..575758.845 rows=16042712 loops=1)
                     ->  Sort  (cost=2529329.13..2530467.81 rows=455473 width=254) (actual time=389733.202..573538.551 rows=16042712 loops=1)
                           Sort Key: partsupp.ps_partkey
                           Sort Method: external merge  Disk: 3027968kB
                           ->  Gather  (cost=29976.62..2377545.48 rows=455473 width=254) (actual time=302600.340..359878.176 rows=16042800 loops=1)
                                 Workers Planned: 2
                                 Workers Launched: 2
                                 ->  Parallel Hash Join  (cost=28976.62..2330998.18 rows=189780 width=254) (actual time=302515.588..346809.969 rows=5347600 loops=3)
                                       Hash Cond: (partsupp.ps_suppkey = supplier.s_suppkey)
                                       ->  Parallel Seq Scan on partsupp  (cost=0.00..2176257.40 rows=33326240 width=22) (actual time=8.872..279783.708 rows=26666667 loops=3)
                                       ->  Parallel Hash  (cost=28945.99..28945.99 rows=2451 width=244) (actual time=3757.807..3757.808 rows=66845 loops=3)
                                             Buckets: 16384 (originally 8192)  Batches: 16 (originally 1)  Memory Usage: 2720kB
                                             ->  Hash Join  (cost=24.31..28945.99 rows=2451 width=244) (actual time=16.905..3667.090 rows=66845 loops=3)
                                                   Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                                   ->  Parallel Seq Scan on supplier  (cost=0.00..27334.67 rows=416667 width=148) (actual time=15.031..3602.594 rows=333333 loops=3)
                                                   ->  Hash  (cost=24.29..24.29 rows=1 width=108) (actual time=1.840..1.840 rows=5 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Hash Join  (cost=12.14..24.29 rows=1 width=108) (actual time=1.817..1.827 rows=5 loops=3)
                                                               Hash Cond: (nation.n_regionkey = region.r_regionkey)
                                                               ->  Seq Scan on nation  (cost=0.00..11.70 rows=170 width=116) (actual time=0.912..0.918 rows=25 loops=3)
                                                               ->  Hash  (cost=12.12..12.12 rows=1 width=4) (actual time=0.868..0.868 rows=1 loops=3)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on region  (cost=0.00..12.12 rows=1 width=4) (actual time=0.855..0.856 rows=1 loops=3)
                                                                           Filter: (r_name = 'EUROPE'::bpchar)
                                                                           Rows Removed by Filter: 4
               SubPlan 1
                 ->  Aggregate  (cost=1863.56..1863.57 rows=1 width=32) (actual time=53.860..53.860 rows=1 loops=64377)
                       ->  Nested Loop  (cost=13.13..1863.56 rows=1 width=6) (actual time=52.307..53.852 rows=2 loops=64377)
                             Join Filter: (supplier_1.s_nationkey = nation_1.n_nationkey)
                             Rows Removed by Join Filter: 18
                             ->  Hash Join  (cost=12.14..24.29 rows=1 width=4) (actual time=0.005..0.015 rows=5 loops=64377)
                                   Hash Cond: (nation_1.n_regionkey = region_1.r_regionkey)
                                   ->  Seq Scan on nation nation_1  (cost=0.00..11.70 rows=170 width=12) (actual time=0.003..0.008 rows=25 loops=64377)
                                   ->  Hash  (cost=12.12..12.12 rows=1 width=4) (actual time=0.042..0.042 rows=1 loops=1)
                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                         ->  Seq Scan on region region_1  (cost=0.00..12.12 rows=1 width=4) (actual time=0.026..0.027 rows=1 loops=1)
                                               Filter: (r_name = 'EUROPE'::bpchar)
                                               Rows Removed by Filter: 4
                             ->  Nested Loop  (cost=0.99..1837.08 rows=175 width=14) (actual time=8.462..10.766 rows=4 loops=321885)
                                   ->  Index Scan using partsupp_pkey on partsupp partsupp_1  (cost=0.57..328.99 rows=181 width=14) (actual time=7.793..8.108 rows=4 loops=321885)
                                         Index Cond: (part.p_partkey = ps_partkey)
                                   ->  Index Scan using supplier_pkey on supplier supplier_1  (cost=0.42..8.33 rows=1 width=12) (actual time=0.664..0.664 rows=1 loops=1287540)
                                         Index Cond: (s_suppkey = partsupp_1.ps_suppkey)
 Planning Time: 1689.647 ms
 Execution Time: 4048448.670 ms
(59 rows)

COMMIT
query3:
BEGIN
                                                                                        QUERY PLAN                                                                       
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=29954786.15..29954786.17 rows=10 width=48) (actual time=3781240.145..3782642.209 rows=10 loops=1)
   ->  Sort  (cost=29954786.15..30033099.92 rows=31325511 width=48) (actual time=3781240.143..3781240.144 rows=10 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC, orders.o_orderdate
         Sort Method: top-N heapsort  Memory: 26kB
         ->  Finalize GroupAggregate  (cost=25155290.31..29277853.12 rows=31325511 width=48) (actual time=3777982.824..3780850.754 rows=1132789 loops=1)
               Group Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
               ->  Gather Merge  (cost=25155290.31..28559976.83 rows=26104592 width=48) (actual time=3777982.790..3780865.066 rows=1132978 loops=1)
                     Workers Planned: 2
                     Workers Launched: 2
                     ->  Partial GroupAggregate  (cost=25154290.29..25545859.17 rows=13052296 width=48) (actual time=3777859.808..3779156.270 rows=377659 loops=3)
                           Group Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
                           ->  Sort  (cost=25154290.29..25186921.03 rows=13052296 width=28) (actual time=3777859.753..3778099.422 rows=997056 loops=3)
                                 Sort Key: lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority
                                 Sort Method: external merge  Disk: 38280kB
                                 Worker 0:  Sort Method: external merge  Disk: 38736kB
                                 Worker 1:  Sort Method: external merge  Disk: 38648kB
                                 ->  Parallel Hash Join  (cost=4593674.89..22987077.46 rows=13052296 width=28) (actual time=3277870.722..3773657.834 rows=997056 loops=3)
                                       Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                                       ->  Parallel Seq Scan on lineitem  (cost=0.00..15413080.00 rows=133344100 width=20) (actual time=0.045..2093020.127 rows=106999953 loops=3)
                                             Filter: (l_shipdate > '1995-03-25'::date)
                                             Rows Removed by Filter: 93012681
                                       ->  Parallel Hash  (cost=4487341.50..4487341.50 rows=6117151 width=12) (actual time=886218.510..886218.511 rows=4899835 loops=3)
                                             Buckets: 131072  Batches: 256  Memory Usage: 3776kB
                                             ->  Parallel Hash Join  (cost=471733.77..4487341.50 rows=6117151 width=12) (actual time=769834.304..874289.860 rows=4899835 loops=3)
                                                   Hash Cond: (orders.o_custkey = customer.c_custkey)
                                                   ->  Parallel Seq Scan on orders  (cost=0.00..3574953.00 rows=30378173 width=20) (actual time=92.622..625086.261 rows=24499226 loops=3)
                                                         Filter: (o_orderdate < '1995-03-25'::date)
                                                         Rows Removed by Filter: 25500774
                                                   ->  Parallel Hash  (cost=451087.01..451087.01 rows=1258461 width=4) (actual time=49717.703..49717.704 rows=999261 loops=3)
                                                         Buckets: 131072  Batches: 64  Memory Usage: 2912kB
                                                         ->  Parallel Seq Scan on customer  (cost=0.00..451087.01 rows=1258461 width=4) (actual time=0.037..48300.383 rows=999261 loops=3)
                                                               Filter: (c_mktsegment = 'MACHINERY'::bpchar)
                                                               Rows Removed by Filter: 4000739
 Planning Time: 1.933 ms
 Execution Time: 3782649.412 ms
(35 rows)

COMMIT
query4:
BEGIN
                                                                              QUERY PLAN                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=18346977.76..18346987.35 rows=1 width=24) (actual time=4468821.437..4469180.253 rows=1 loops=1)
   ->  Finalize GroupAggregate  (cost=18346977.76..18347025.70 rows=5 width=24) (actual time=4468821.435..4468821.435 rows=1 loops=1)
         Group Key: orders.o_orderpriority
         ->  Gather Merge  (cost=18346977.76..18347025.60 rows=10 width=24) (actual time=4468470.311..4469180.206 rows=3 loops=1)
               Workers Planned: 2
               Workers Launched: 1
               ->  Partial GroupAggregate  (cost=18345977.74..18346024.42 rows=5 width=24) (actual time=4467839.145..4468360.285 rows=2 loops=2)
                     Group Key: orders.o_orderpriority
                     ->  Sort  (cost=18345977.74..18345993.28 rows=6218 width=16) (actual time=4467304.462..4468153.396 rows=1315304 loops=2)
                           Sort Key: orders.o_orderpriority
                           Sort Method: external merge  Disk: 66928kB
                           Worker 0:  Sort Method: external merge  Disk: 67056kB
                           ->  Nested Loop Semi Join  (cost=0.57..18345585.93 rows=6218 width=16) (actual time=57.591..4457546.077 rows=2631186 loops=2)
                                 ->  Parallel Seq Scan on orders  (cost=0.00..3731187.20 rows=2463957 width=20) (actual time=0.072..1108044.738 rows=2869528 loops=2)
                                       Filter: ((o_orderdate >= '1996-11-01'::date) AND (o_orderdate < '1997-02-01 00:00:00'::timestamp without time zone))
                                       Rows Removed by Filter: 72130472
                                 ->  Index Scan using lineitem_pkey on lineitem  (cost=0.57..2821.58 rows=528 width=8) (actual time=1.166..1.166 rows=1 loops=5739057)
                                       Index Cond: (l_orderkey = orders.o_orderkey)
                                       Filter: (l_commitdate < l_receiptdate)
                                       Rows Removed by Filter: 1
 Planning Time: 2556.532 ms
 Execution Time: 4469191.755 ms
(22 rows)

COMMIT
query5:
BEGIN
                                                                                                 QUERY PLAN                                                              
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=20288559.20..20288559.21 rows=1 width=136) (actual time=4982241.295..4988647.871 rows=1 loops=1)
   ->  Sort  (cost=20288559.20..20288559.63 rows=170 width=136) (actual time=4982241.293..4982241.293 rows=1 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  Finalize GroupAggregate  (cost=20288402.37..20288558.35 rows=170 width=136) (actual time=4981881.603..4982241.218 rows=5 loops=1)
               Group Key: nation.n_name
               ->  Gather Merge  (cost=20288402.37..20288553.68 rows=340 width=136) (actual time=4981758.339..4988646.909 rows=5 loops=1)
                     Workers Planned: 2
                     Workers Launched: 0
                     ->  Partial GroupAggregate  (cost=20287402.35..20287514.41 rows=170 width=136) (actual time=4981757.650..4982240.423 rows=5 loops=1)
                           Group Key: nation.n_name
                           ->  Sort  (cost=20287402.35..20287424.33 rows=8795 width=116) (actual time=4981632.294..4981809.981 rows=731008 loops=1)
                                 Sort Key: nation.n_name
                                 Sort Method: external merge  Disk: 35488kB
                                 ->  Parallel Hash Join  (cost=19739128.50..20286826.17 rows=8795 width=116) (actual time=4975974.171..4981144.892 rows=731008 loops=1)
                                       Hash Cond: ((customer.c_custkey = orders.o_custkey) AND (customer.c_nationkey = supplier.s_nationkey))
                                       ->  Parallel Seq Scan on customer  (cost=0.00..435463.01 rows=6249601 width=12) (actual time=18.934..10118.448 rows=15000000 loops=1)
                                       ->  Parallel Hash  (cost=19731537.04..19731537.04 rows=219831 width=136) (actual time=4959676.231..4959676.232 rows=18273138 loops=1)
                                             Buckets: 32768 (originally 32768)  Batches: 512 (originally 32)  Memory Usage: 3680kB
                                             ->  Parallel Hash Join  (cost=15806761.74..19731537.04 rows=219831 width=136) (actual time=4653216.605..4942975.053 rows=18273138 loops=1)
                                                   Hash Cond: (orders.o_orderkey = lineitem.l_orderkey)
                                                   ->  Parallel Seq Scan on orders  (cost=0.00..3731187.20 rows=9528151 width=12) (actual time=0.189..124968.184 rows=22819651 loops=1)
                                                         Filter: ((o_orderdate >= '1996-01-01'::date) AND (o_orderdate < '1997-01-01 00:00:00'::timestamp without time zone))
                                                         Rows Removed by Filter: 127180349
                                                   ->  Parallel Hash  (cost=15760577.74..15760577.74 rows=1441840 width=136) (actual time=4510809.238..4510809.238 rows=120078639 loops=1)
                                                         Buckets: 32768 (originally 32768)  Batches: 4096 (originally 256)  Memory Usage: 3104kB
                                                         ->  Parallel Hash Join  (cost=28976.62..15760577.74 rows=1441840 width=136) (actual time=2507687.893..3691754.221 rows=120078639 loops=1)
                                                               Hash Cond: (lineitem.l_suppkey = supplier.s_suppkey)
                                                               ->  Parallel Seq Scan on lineitem  (cost=0.00..14788053.20 rows=250010720 width=28) (actual time=0.016..2147035.552 rows=600037902 loops=1)
                                                               ->  Parallel Hash  (cost=28945.99..28945.99 rows=2451 width=120) (actual time=18969.949..18969.949 rows=200123 loops=1)
                                                                     Buckets: 65536 (originally 8192)  Batches: 8 (originally 1)  Memory Usage: 2496kB
                                                                     ->  Hash Join  (cost=24.31..28945.99 rows=2451 width=120) (actual time=220.573..17372.423 rows=200123 loops=1)
                                                                           Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                                                           ->  Parallel Seq Scan on supplier  (cost=0.00..27334.67 rows=416667 width=12) (actual time=0.012..16984.079 rows=1000000 loops=1)
                                                                           ->  Hash  (cost=24.29..24.29 rows=1 width=108) (actual time=220.541..220.541 rows=5 loops=1)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                 ->  Hash Join  (cost=12.14..24.29 rows=1 width=108) (actual time=220.511..220.523 rows=5 loops=1)
                                                                                       Hash Cond: (nation.n_regionkey = region.r_regionkey)
                                                                                       ->  Seq Scan on nation  (cost=0.00..11.70 rows=170 width=116) (actual time=0.013..0.018 rows=25 loops=1)
                                                                                       ->  Hash  (cost=12.12..12.12 rows=1 width=4) (actual time=220.479..220.480 rows=1 loops=1)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                             ->  Seq Scan on region  (cost=0.00..12.12 rows=1 width=4) (actual time=220.459..220.462 rows=1 loops=1)
                                                                                                   Filter: (r_name = 'AFRICA'::bpchar)
                                                                                                   Rows Removed by Filter: 4
 Planning Time: 3413.701 ms
 Execution Time: 4988655.547 ms
(46 rows)

COMMIT
query6:
BEGIN
                                                                                                           QUERY PLAN                                                                                                            
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=17938136.23..17938136.24 rows=1 width=32) (actual time=529151.829..529160.587 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=17938136.23..17938136.24 rows=1 width=32) (actual time=529151.827..529151.828 rows=1 loops=1)
         ->  Gather  (cost=17938136.01..17938136.22 rows=2 width=32) (actual time=529151.535..529160.554 rows=3 loops=1)
               Workers Planned: 2
               Workers Launched: 2
               ->  Partial Aggregate  (cost=17937136.01..17937136.02 rows=1 width=32) (actual time=529133.987..529133.988 rows=1 loops=3)
                     ->  Parallel Seq Scan on lineitem  (cost=0.00..17913187.20 rows=4789761 width=12) (actual time=13.908..525622.887 rows=3818033 loops=3)
                           Filter: ((l_shipdate >= '1996-01-01'::date) AND (l_shipdate < '1997-01-01 00:00:00'::timestamp without time zone) AND (l_discount >= 0.02) AND (l_discount <= 0.04) AND (l_quantity < '24'::numeric))
                           Rows Removed by Filter: 196194601
 Planning Time: 29.252 ms
 Execution Time: 529160.708 ms
(11 rows)

COMMIT
query7:
BEGIN
                                                                                         QUERY PLAN                                                                      
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=21145264.58..21145264.75 rows=1 width=248) (actual time=2778108.597..2778689.311 rows=1 loops=1)
   ->  Finalize GroupAggregate  (cost=21145264.58..21146935.11 rows=10032 width=248) (actual time=2778108.594..2778108.595 rows=1 loops=1)
         Group Key: n1.n_name, n2.n_name, (date_part('year'::text, (lineitem.l_shipdate)::timestamp without time zone))
         ->  Gather Merge  (cost=21145264.58..21146631.05 rows=10280 width=248) (actual time=2778044.767..2778689.107 rows=4 loops=1)
               Workers Planned: 2
               Workers Launched: 2
               ->  Partial GroupAggregate  (cost=21144264.56..21144444.46 rows=5140 width=248) (actual time=2778030.818..2778132.928 rows=3 loops=3)
                     Group Key: n1.n_name, n2.n_name, (date_part('year'::text, (lineitem.l_shipdate)::timestamp without time zone))
                     ->  Sort  (cost=21144264.56..21144277.41 rows=5140 width=228) (actual time=2777966.555..2778031.640 rows=130509 loops=3)
                           Sort Key: n1.n_name, n2.n_name, (date_part('year'::text, (lineitem.l_shipdate)::timestamp without time zone))
                           Sort Method: external merge  Disk: 16240kB
                           Worker 0:  Sort Method: external merge  Disk: 16528kB
                           Worker 1:  Sort Method: external merge  Disk: 17296kB
                           ->  Parallel Hash Join  (cost=4772000.14..21143947.74 rows=5140 width=228) (actual time=2655287.992..2777680.095 rows=194474 loops=3)
                                 Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                                 Join Filter: (((n1.n_name = 'ETHIOPIA'::bpchar) AND (n2.n_name = 'JAPAN'::bpchar)) OR ((n1.n_name = 'JAPAN'::bpchar) AND (n2.n_name = 'ETHIOPIA'::bpchar)))
                                 Rows Removed by Join Filter: 194639
                                 ->  Parallel Hash Join  (cost=28529.53..16352666.88 rows=868639 width=128) (actual time=4913.767..2384989.661 rows=4870553 loops=3)
                                       Hash Cond: (lineitem.l_suppkey = supplier.s_suppkey)
                                       ->  Parallel Seq Scan on lineitem  (cost=0.00..16038106.80 rows=75309649 width=32) (actual time=25.021..2353633.481 rows=60767063 loops=3)
                                             Filter: ((l_shipdate >= '1995-01-01'::date) AND (l_shipdate <= '1996-12-31'::date))
                                             Rows Removed by Filter: 139245571
                                       ->  Parallel Hash  (cost=28468.26..28468.26 rows=4902 width=108) (actual time=4888.265..4888.265 rows=26717 loops=3)
                                             Buckets: 131072 (originally 16384)  Batches: 1 (originally 1)  Memory Usage: 6976kB
                                             ->  Hash Join  (cost=12.58..28468.26 rows=4902 width=108) (actual time=7.882..4851.528 rows=26717 loops=3)
                                                   Hash Cond: (supplier.s_nationkey = n1.n_nationkey)
                                                   ->  Parallel Seq Scan on supplier  (cost=0.00..27334.67 rows=416667 width=12) (actual time=7.790..4789.479 rows=333333 loops=3)
                                                   ->  Hash  (cost=12.55..12.55 rows=2 width=108) (actual time=0.063..0.063 rows=2 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on nation n1  (cost=0.00..12.55 rows=2 width=108) (actual time=0.041..0.048 rows=2 loops=3)
                                                               Filter: ((n_name = 'ETHIOPIA'::bpchar) OR (n_name = 'JAPAN'::bpchar))
                                                               Rows Removed by Filter: 23
                                 ->  Parallel Hash  (cost=4722074.36..4722074.36 rows=735220 width=108) (actual time=214437.881..214437.881 rows=3997933 loops=3)
                                       Buckets: 32768 (originally 32768)  Batches: 256 (originally 128)  Memory Usage: 3264kB
                                       ->  Parallel Hash Join  (cost=454429.83..4722074.36 rows=735220 width=108) (actual time=184272.207..211875.469 rows=3997933 loops=3)
                                             Hash Cond: (orders.o_custkey = customer.c_custkey)
                                             ->  Parallel Seq Scan on orders  (cost=0.00..3418718.80 rows=62493680 width=12) (actual time=9.163..149322.130 rows=50000000 loops=3)
                                             ->  Parallel Hash  (cost=452289.76..452289.76 rows=73525 width=108) (actual time=16380.654..16380.654 rows=399980 loops=3)
                                                   Buckets: 32768 (originally 32768)  Batches: 32 (originally 8)  Memory Usage: 2656kB
                                                   ->  Hash Join  (cost=12.58..452289.76 rows=73525 width=108) (actual time=3.871..15588.853 rows=399980 loops=3)
                                                         Hash Cond: (customer.c_nationkey = n2.n_nationkey)
                                                         ->  Parallel Seq Scan on customer  (cost=0.00..435463.01 rows=6249601 width=12) (actual time=3.629..14763.186 rows=5000000 loops=3)
                                                         ->  Hash  (cost=12.55..12.55 rows=2 width=108) (actual time=0.191..0.191 rows=2 loops=3)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                               ->  Seq Scan on nation n2  (cost=0.00..12.55 rows=2 width=108) (actual time=0.169..0.177 rows=2 loops=3)
                                                                     Filter: ((n_name = 'JAPAN'::bpchar) OR (n_name = 'ETHIOPIA'::bpchar))
                                                                     Rows Removed by Filter: 23
 Planning Time: 218.123 ms
 Execution Time: 2778692.565 ms
(49 rows)

COMMIT
query8:
BEGIN
                                                                                                QUERY PLAN                                                               
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=20273811.77..20273812.08 rows=1 width=40) (actual time=3227057.428..3227192.633 rows=1 loops=1)
   ->  Finalize GroupAggregate  (cost=20273811.77..20274560.16 rows=2406 width=40) (actual time=3227057.426..3227057.427 rows=1 loops=1)
         Group Key: (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))
         ->  Gather Merge  (cost=20273811.77..20274447.85 rows=4654 width=72) (actual time=3227023.395..3227192.516 rows=4 loops=1)
               Workers Planned: 2
               Workers Launched: 2
               ->  Partial GroupAggregate  (cost=20272811.74..20272910.64 rows=2327 width=72) (actual time=3227016.535..3227049.226 rows=2 loops=3)
                     Group Key: (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))
                     ->  Sort  (cost=20272811.74..20272817.56 rows=2327 width=124) (actual time=3226983.688..3226996.063 rows=81235 loops=3)
                           Sort Key: (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))
                           Sort Method: external merge  Disk: 4712kB
                           Worker 0:  Sort Method: external merge  Disk: 4320kB
                           Worker 1:  Sort Method: external merge  Disk: 4696kB
                           ->  Hash Join  (cost=4785635.00..20272681.61 rows=2327 width=124) (actual time=3042055.807..3226510.798 rows=81235 loops=3)
                                 Hash Cond: (supplier.s_nationkey = n2.n_nationkey)
                                 ->  Nested Loop  (cost=4785621.17..20272649.89 rows=2327 width=24) (actual time=3042055.682..3226409.089 rows=81235 loops=3)
                                       ->  Parallel Hash Join  (cost=4785620.75..20253243.93 rows=2373 width=24) (actual time=3041941.645..3136476.618 rows=81235 loops=3)
                                             Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                                             ->  Parallel Hash Join  (cost=520230.69..15964562.14 rows=1310891 width=28) (actual time=390009.952..2024545.523 rows=1336046 loops=3)
                                                   Hash Cond: (lineitem.l_partkey = part.p_partkey)
                                                   ->  Parallel Seq Scan on lineitem  (cost=0.00..14788053.20 rows=250010720 width=36) (actual time=0.071..1560295.162 rows=200012634 loops=3)
                                                   ->  Parallel Hash  (cost=519538.70..519538.70 rows=55359 width=4) (actual time=389988.473..389988.476 rows=44494 loops=3)
                                                         Buckets: 262144  Batches: 1  Memory Usage: 7296kB
                                                         ->  Parallel Seq Scan on part  (cost=0.00..519538.70 rows=55359 width=4) (actual time=11.803..389919.498 rows=44494 loops=3)
                                                               Filter: ((p_type)::text = 'LARGE BRUSHED NICKEL'::text)
                                                               Rows Removed by Filter: 6622173
                                             ->  Parallel Hash  (cost=4263533.85..4263533.85 rows=113137 width=8) (actual time=1012619.311..1012619.311 rows=3034268 loops=3)
                                                   Buckets: 131072 (originally 131072)  Batches: 128 (originally 4)  Memory Usage: 3872kB
                                                   ->  Parallel Hash Join  (cost=459750.46..4263533.85 rows=113137 width=8) (actual time=914632.602..996146.762 rows=3034268 loops=3)
                                                         Hash Cond: (orders.o_custkey = customer.c_custkey)
                                                         ->  Parallel Seq Scan on orders  (cost=0.00..3731187.20 rows=19233276 width=16) (actual time=30.039..807122.799 rows=15191541 loops=3)
                                                               Filter: ((o_orderdate >= '1995-01-01'::date) AND (o_orderdate <= '1996-12-31'::date))
                                                               Rows Removed by Filter: 34808459
                                                         ->  Parallel Hash  (cost=459290.94..459290.94 rows=36762 width=4) (actual time=47674.558..47674.558 rows=999920 loops=3)
                                                               Buckets: 131072 (originally 131072)  Batches: 32 (originally 1)  Memory Usage: 4800kB
                                                               ->  Hash Join  (cost=24.31..459290.94 rows=36762 width=4) (actual time=14.119..46459.367 rows=999920 loops=3)
                                                                     Hash Cond: (customer.c_nationkey = n1.n_nationkey)
                                                                     ->  Parallel Seq Scan on customer  (cost=0.00..435463.01 rows=6249601 width=12) (actual time=13.085..45496.106 rows=5000000 loops=3)
                                                                     ->  Hash  (cost=24.29..24.29 rows=1 width=4) (actual time=1.001..1.001 rows=5 loops=3)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                           ->  Hash Join  (cost=12.14..24.29 rows=1 width=4) (actual time=0.976..0.987 rows=5 loops=3)
                                                                                 Hash Cond: (n1.n_regionkey = region.r_regionkey)
                                                                                 ->  Seq Scan on nation n1  (cost=0.00..11.70 rows=170 width=12) (actual time=0.018..0.025 rows=25 loops=3)
                                                                                 ->  Hash  (cost=12.12..12.12 rows=1 width=4) (actual time=0.925..0.925 rows=1 loops=3)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                                       ->  Seq Scan on region  (cost=0.00..12.12 rows=1 width=4) (actual time=0.911..0.913 rows=1 loops=3)
                                                                                             Filter: (r_name = 'ASIA'::bpchar)
                                                                                             Rows Removed by Filter: 4
                                       ->  Index Scan using supplier_pkey on supplier  (cost=0.42..8.18 rows=1 width=12) (actual time=1.106..1.106 rows=1 loops=243705)
                                             Index Cond: (s_suppkey = lineitem.l_suppkey)
                                 ->  Hash  (cost=11.70..11.70 rows=170 width=108) (actual time=0.034..0.034 rows=25 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                       ->  Seq Scan on nation n2  (cost=0.00..11.70 rows=170 width=108) (actual time=0.017..0.022 rows=25 loops=3)
 Planning Time: 1305.200 ms
 Execution Time: 3227194.256 ms
(55 rows)

COMMIT
query9:
BEGIN
                                                                                               QUERY PLAN                                                                
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=23569711.86..23569712.00 rows=1 width=144) (actual time=29745662.829..29748523.861 rows=1 loops=1)
   ->  Finalize GroupAggregate  (cost=23569711.86..23569719.78 rows=57 width=144) (actual time=29745662.823..29745662.824 rows=1 loops=1)
         Group Key: nation.n_name, (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))
         ->  Gather Merge  (cost=23569711.86..23569718.30 rows=48 width=144) (actual time=29745570.139..29748521.401 rows=4 loops=1)
               Workers Planned: 2
               Workers Launched: 2
               ->  Partial GroupAggregate  (cost=23568711.84..23568712.74 rows=24 width=144) (actual time=29745188.584..29745544.595 rows=5 loops=3)
                     Group Key: nation.n_name, (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))
                     ->  Sort  (cost=23568711.84..23568711.90 rows=24 width=135) (actual time=29745129.902..29745236.513 rows=294659 loops=3)
                           Sort Key: nation.n_name, (date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)) DESC
                           Sort Method: external merge  Disk: 804920kB
                           Worker 0:  Sort Method: external merge  Disk: 808224kB
                           Worker 1:  Sort Method: external merge  Disk: 790552kB
                           ->  Hash Join  (cost=2871437.26..23568711.29 rows=24 width=135) (actual time=2794368.024..29642847.132 rows=10852773 loops=3)
                                 Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                 ->  Nested Loop  (cost=2871423.43..23568697.28 rows=24 width=35) (actual time=2794367.878..29615198.830 rows=10852773 loops=3)
                                       ->  Nested Loop  (cost=2871422.86..23568496.84 rows=24 width=39) (actual time=2794049.162..10762733.351 rows=10852773 loops=3)
                                             ->  Nested Loop  (cost=2871422.44..23568300.03 rows=24 width=47) (actual time=2794028.746..10448230.949 rows=10852773 loops=3)
                                                   ->  Parallel Hash Join  (cost=2871422.00..23562022.48 rows=764 width=63) (actual time=2792831.348..3531621.889 rows=200012634 loops=3)
                                                         Hash Cond: ((lineitem.l_suppkey = partsupp.ps_suppkey) AND (lineitem.l_partkey = partsupp.ps_partkey))
                                                         ->  Parallel Seq Scan on lineitem  (cost=0.00..14788053.20 rows=250010720 width=41) (actual time=0.064..1402297.977 rows=200012634 loops=3)
                                                         ->  Parallel Hash  (cost=2176257.40..2176257.40 rows=33326240 width=22) (actual time=1137478.294..1137478.295 rows=26666667 loops=3)
                                                               Buckets: 65536  Batches: 2048  Memory Usage: 2720kB
                                                               ->  Parallel Seq Scan on partsupp  (cost=0.00..2176257.40 rows=33326240 width=22) (actual time=4.787..1005961.383 rows=26666667 loops=3)
                                                   ->  Index Scan using part_pkey on part  (cost=0.44..8.22 rows=1 width=4) (actual time=0.034..0.034 rows=0 loops=600037902)
                                                         Index Cond: (p_partkey = partsupp.ps_partkey)
                                                         Filter: ((p_name)::text ~~ '%orchid%'::text)
                                                         Rows Removed by Filter: 1
                                             ->  Index Scan using supplier_pkey on supplier  (cost=0.42..8.20 rows=1 width=12) (actual time=0.028..0.028 rows=1 loops=32558318)
                                                   Index Cond: (s_suppkey = lineitem.l_suppkey)
                                       ->  Index Scan using orders_pkey on orders  (cost=0.57..8.35 rows=1 width=8) (actual time=1.736..1.736 rows=1 loops=32558318)
                                             Index Cond: (o_orderkey = lineitem.l_orderkey)
                                 ->  Hash  (cost=11.70..11.70 rows=170 width=108) (actual time=0.040..0.040 rows=25 loops=3)
                                       Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                       ->  Seq Scan on nation  (cost=0.00..11.70 rows=170 width=108) (actual time=0.019..0.024 rows=25 loops=3)
 Planning Time: 386.183 ms
 Execution Time: 29748676.149 ms
(37 rows)

COMMIT
query10:
BEGIN
                                                                                          QUERY PLAN                                                                     
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=22689694.85..22689694.90 rows=20 width=279) (actual time=3863773.574..3866397.417 rows=20 loops=1)
   ->  Sort  (cost=22689694.85..22704362.72 rows=5867150 width=279) (actual time=3863773.573..3863773.574 rows=20 loops=1)
         Sort Key: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC
         Sort Method: top-N heapsort  Memory: 33kB
         ->  Finalize GroupAggregate  (cost=21779766.42..22533572.09 rows=5867150 width=279) (actual time=3847461.583..3861797.004 rows=3883731 loops=1)
               Group Key: customer.c_custkey, nation.n_name
               ->  Gather Merge  (cost=21779766.42..22411339.80 rows=4889292 width=279) (actual time=3847461.527..3858606.150 rows=3884034 loops=1)
                     Workers Planned: 2
                     Workers Launched: 1
                     ->  Partial GroupAggregate  (cost=21778766.40..21845994.16 rows=2444646 width=279) (actual time=3847434.279..3855957.674 rows=1942017 loops=2)
                           Group Key: customer.c_custkey, nation.n_name
                           ->  Sort  (cost=21778766.40..21784878.01 rows=2444646 width=259) (actual time=3847434.231..3849271.734 rows=5727744 loops=2)
                                 Sort Key: customer.c_custkey, nation.n_name
                                 Sort Method: external merge  Disk: 1091016kB
                                 Worker 0:  Sort Method: external merge  Disk: 1093760kB
                                 ->  Hash Join  (cost=4421604.60..20917759.86 rows=2444646 width=259) (actual time=3473373.334..3820435.292 rows=5727744 loops=2)
                                       Hash Cond: (customer.c_nationkey = nation.n_nationkey)
                                       ->  Parallel Hash Join  (cost=4421590.77..20911168.86 rows=2444646 width=163) (actual time=3473373.199..3818755.194 rows=5727744 loops=2)
                                             Hash Cond: (orders.o_custkey = customer.c_custkey)
                                             ->  Parallel Hash Join  (cost=3773738.75..20093980.65 rows=2444646 width=20) (actual time=2703329.531..3202114.826 rows=5727744 loops=2)
                                                   Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                                                   ->  Parallel Seq Scan on lineitem  (cost=0.00..15413080.00 rows=62411008 width=20) (actual time=22.971..1595604.742 rows=74033630 loops=2)
                                                         Filter: (l_returnflag = 'R'::bpchar)
                                                         Rows Removed by Filter: 225985320
                                                   ->  Parallel Hash  (cost=3731187.20..3731187.20 rows=2447884 width=12) (actual time=965509.796..965509.797 rows=2868268 loops=2)
                                                         Buckets: 131072  Batches: 128  Memory Usage: 3168kB
                                                         ->  Parallel Seq Scan on orders  (cost=0.00..3731187.20 rows=2447884 width=12) (actual time=0.050..937702.895 rows=2868268 loops=2)
                                                               Filter: ((o_orderdate >= '1994-11-01'::date) AND (o_orderdate < '1995-02-01 00:00:00'::timestamp without time zone))
                                                               Rows Removed by Filter: 72131732
                                             ->  Parallel Hash  (cost=435463.01..435463.01 rows=6249601 width=151) (actual time=237861.896..237861.896 rows=7500000 loops=2)
                                                   Buckets: 32768  Batches: 1024  Memory Usage: 3040kB
                                                   ->  Parallel Seq Scan on customer  (cost=0.00..435463.01 rows=6249601 width=151) (actual time=0.042..207958.000 rows=7500000 loops=2)
                                       ->  Hash  (cost=11.70..11.70 rows=170 width=108) (actual time=0.039..0.039 rows=25 loops=2)
                                             Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                             ->  Seq Scan on nation  (cost=0.00..11.70 rows=170 width=108) (actual time=0.018..0.024 rows=25 loops=2)
 Planning Time: 1269.204 ms
 Execution Time: 3867116.011 ms
(37 rows)

COMMIT
query11:
BEGIN
                                                                                    QUERY PLAN                                                                           
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=4746759.31..4746759.31 rows=1 width=40) (actual time=245686.320..245686.320 rows=0 loops=1)
   InitPlan 1 (returns $1)
     ->  Finalize Aggregate  (cost=2332943.59..2332943.61 rows=1 width=32) (actual time=16083.736..16083.737 rows=1 loops=1)
           ->  Gather  (cost=2332943.37..2332943.58 rows=2 width=32) (actual time=16083.356..16084.376 rows=3 loops=1)
                 Workers Planned: 2
                 Workers Launched: 2
                 ->  Partial Aggregate  (cost=2331943.37..2331943.38 rows=1 width=32) (actual time=16027.259..16027.259 rows=1 loops=3)
                       ->  Parallel Hash Join  (cost=28498.46..2330520.02 rows=189780 width=10) (actual time=153.257..15348.175 rows=1062373 loops=3)
                             Hash Cond: (partsupp_1.ps_suppkey = supplier_1.s_suppkey)
                             ->  Parallel Seq Scan on partsupp partsupp_1  (cost=0.00..2176257.40 rows=33326240 width=18) (actual time=0.051..9715.047 rows=26666667 loops=3)
                             ->  Parallel Hash  (cost=28467.82..28467.82 rows=2451 width=4) (actual time=152.809..152.809 rows=13280 loops=3)
                                   Buckets: 65536 (originally 8192)  Batches: 1 (originally 1)  Memory Usage: 2592kB
                                   ->  Hash Join  (cost=12.14..28467.82 rows=2451 width=4) (actual time=0.088..137.004 rows=13280 loops=3)
                                         Hash Cond: (supplier_1.s_nationkey = nation_1.n_nationkey)
                                         ->  Parallel Seq Scan on supplier supplier_1  (cost=0.00..27334.67 rows=416667 width=12) (actual time=0.029..99.874 rows=333333 loops=3)
                                         ->  Hash  (cost=12.12..12.12 rows=1 width=4) (actual time=0.033..0.034 rows=1 loops=3)
                                               Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                               ->  Seq Scan on nation nation_1  (cost=0.00..12.12 rows=1 width=4) (actual time=0.023..0.027 rows=1 loops=3)
                                                     Filter: (n_name = 'ARGENTINA'::bpchar)
                                                     Rows Removed by Filter: 24
   ->  Sort  (cost=2413815.70..2414183.79 rows=147235 width=40) (actual time=245686.319..245686.319 rows=0 loops=1)
         Sort Key: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric))) DESC
         Sort Method: quicksort  Memory: 25kB
         ->  Finalize GroupAggregate  (cost=2352050.03..2413079.52 rows=147235 width=40) (actual time=245686.292..245686.296 rows=0 loops=1)
               Group Key: partsupp.ps_partkey
               Filter: (sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric)) > $1)
               Rows Removed by Filter: 3000449
               ->  Gather Merge  (cost=2352050.03..2400605.17 rows=379560 width=40) (actual time=222852.625..226270.649 rows=3008003 loops=1)
                     Workers Planned: 2
                     Workers Launched: 2
                     ->  Partial GroupAggregate  (cost=2351050.00..2355794.50 rows=189780 width=40) (actual time=222535.104..224750.222 rows=1002668 loops=3)
                           Group Key: partsupp.ps_partkey
                           ->  Sort  (cost=2351050.00..2351524.45 rows=189780 width=18) (actual time=222535.071..223173.693 rows=1062373 loops=3)
                                 Sort Key: partsupp.ps_partkey
                                 Sort Method: external merge  Disk: 31248kB
                                 Worker 0:  Sort Method: external merge  Disk: 31312kB
                                 Worker 1:  Sort Method: external merge  Disk: 31024kB
                                 ->  Parallel Hash Join  (cost=28498.46..2330520.02 rows=189780 width=18) (actual time=184.233..220725.272 rows=1062373 loops=3)
                                       Hash Cond: (partsupp.ps_suppkey = supplier.s_suppkey)
                                       ->  Parallel Seq Scan on partsupp  (cost=0.00..2176257.40 rows=33326240 width=26) (actual time=20.579..213805.738 rows=26666667 loops=3)
                                       ->  Parallel Hash  (cost=28467.82..28467.82 rows=2451 width=4) (actual time=163.456..163.456 rows=13280 loops=3)
                                             Buckets: 65536 (originally 8192)  Batches: 1 (originally 1)  Memory Usage: 2560kB
                                             ->  Hash Join  (cost=12.14..28467.82 rows=2451 width=4) (actual time=0.207..158.116 rows=13280 loops=3)
                                                   Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                                   ->  Parallel Seq Scan on supplier  (cost=0.00..27334.67 rows=416667 width=12) (actual time=0.022..122.761 rows=333333 loops=3)
                                                   ->  Hash  (cost=12.12..12.12 rows=1 width=4) (actual time=0.152..0.153 rows=1 loops=3)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                         ->  Seq Scan on nation  (cost=0.00..12.12 rows=1 width=4) (actual time=0.134..0.139 rows=1 loops=3)
                                                               Filter: (n_name = 'ARGENTINA'::bpchar)
                                                               Rows Removed by Filter: 24
 Planning Time: 630.951 ms
 Execution Time: 245704.420 ms
(52 rows)

COMMIT
query12:
BEGIN
                                                                                                                                     QUERY PLAN                                                                                                                                      
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=23041561.21..23044978.74 rows=1 width=27) (actual time=2587590.515..2589949.590 rows=1 loops=1)
   ->  Finalize GroupAggregate  (cost=23041561.21..23065483.93 rows=7 width=27) (actual time=2587590.509..2587590.509 rows=1 loops=1)
         Group Key: lineitem.l_shipmode
         ->  Gather Merge  (cost=23041561.21..23065483.75 rows=14 width=27) (actual time=2587292.685..2589948.865 rows=4 loops=1)
               Workers Planned: 2
               Workers Launched: 2
               ->  Partial GroupAggregate  (cost=23040561.18..23064482.11 rows=7 width=27) (actual time=2587284.498..2587576.703 rows=2 loops=3)
                     Group Key: lineitem.l_shipmode
                     ->  Sort  (cost=23040561.18..23043551.29 rows=1196043 width=27) (actual time=2586973.304..2587190.644 rows=1038550 loops=3)
                           Sort Key: lineitem.l_shipmode
                           Sort Method: external merge  Disk: 37600kB
                           Worker 0:  Sort Method: external merge  Disk: 37928kB
                           Worker 1:  Sort Method: external merge  Disk: 37552kB
                           ->  Parallel Hash Join  (cost=4566063.80..22862582.61 rows=1196043 width=27) (actual time=1798819.574..2586198.011 rows=1038550 loops=3)
                                 Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                                 ->  Parallel Seq Scan on lineitem  (cost=0.00..17913187.20 rows=1196043 width=19) (actual time=352.708..1139129.626 rows=1038550 loops=3)
                                       Filter: ((l_shipmode = ANY ('{TRUCK,RAIL}'::bpchar[])) AND (l_commitdate < l_receiptdate) AND (l_shipdate < l_commitdate) AND (l_receiptdate >= '1994-01-01'::date) AND (l_receiptdate < '1995-01-01 00:00:00'::timestamp without time zone))
                                       Rows Removed by Filter: 198974084
                                 ->  Parallel Hash  (cost=3418718.80..3418718.80 rows=62493680 width=20) (actual time=647709.677..647709.678 rows=50000000 loops=3)
                                       Buckets: 65536  Batches: 4096  Memory Usage: 2592kB
                                       ->  Parallel Seq Scan on orders  (cost=0.00..3418718.80 rows=62493680 width=20) (actual time=43.801..544234.833 rows=50000000 loops=3)
 Planning Time: 867.254 ms
 Execution Time: 2589956.705 ms
(23 rows)

COMMIT
query13:
BEGIN
                                                                                       QUERY PLAN                                                                                        
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=21472206.73..21472206.74 rows=1 width=16) (actual time=593347.287..597538.843 rows=1 loops=1)
   ->  Sort  (cost=21472206.73..21472207.23 rows=200 width=16) (actual time=593347.285..593347.286 rows=1 loops=1)
         Sort Key: (count(*)) DESC, (count(orders.o_orderkey)) DESC
         Sort Method: top-N heapsort  Memory: 25kB
         ->  HashAggregate  (cost=21472203.73..21472205.73 rows=200 width=16) (actual time=593347.232..593347.241 rows=45 loops=1)
               Group Key: count(orders.o_orderkey)
               ->  Finalize GroupAggregate  (cost=16866067.89..21247218.10 rows=14999042 width=12) (actual time=565354.551..590248.660 rows=15000000 loops=1)
                     Group Key: customer.c_custkey
                     ->  Gather Merge  (cost=16866067.89..20947237.26 rows=29998084 width=12) (actual time=565354.530..588936.811 rows=15000000 loops=1)
                           Workers Planned: 2
                           Workers Launched: 2
                           ->  Partial GroupAggregate  (cost=16865067.87..17483714.02 rows=14999042 width=12) (actual time=564997.337..582477.114 rows=5000000 loops=3)
                                 Group Key: customer.c_custkey
                                 ->  Sort  (cost=16865067.87..17021286.44 rows=62487431 width=8) (actual time=564997.294..573075.432 rows=51130477 loops=3)
                                       Sort Key: customer.c_custkey
                                       Sort Method: external merge  Disk: 890720kB
                                       Worker 0:  Sort Method: external merge  Disk: 900752kB
                                       Worker 1:  Sort Method: external merge  Disk: 890760kB
                                       ->  Parallel Hash Left Join  (cost=4661160.89..6210897.28 rows=62487431 width=8) (actual time=201540.182..527558.892 rows=51130477 loops=3)
                                             Hash Cond: (customer.c_custkey = orders.o_custkey)
                                             ->  Parallel Seq Scan on customer  (cost=0.00..435463.01 rows=6249601 width=4) (actual time=12.078..13555.932 rows=5000000 loops=3)
                                             ->  Parallel Hash  (cost=3574953.00..3574953.00 rows=62487431 width=12) (actual time=184616.572..184616.573 rows=49463749 loops=3)
                                                   Buckets: 131072  Batches: 4096  Memory Usage: 2912kB
                                                   ->  Parallel Seq Scan on orders  (cost=0.00..3574953.00 rows=62487431 width=12) (actual time=1.523..149755.303 rows=49463749 loops=3)
                                                         Filter: ((o_comment)::text !~~ '%pending%packages%'::text)
                                                         Rows Removed by Filter: 536251
 Planning Time: 96.659 ms
 Execution Time: 597687.489 ms
(28 rows)

COMMIT
query14:
BEGIN
                                                                            QUERY PLAN                                                                             
-------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=16849614.97..16849614.99 rows=1 width=32) (actual time=1019050.480..1019361.265 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=16849614.97..16849614.99 rows=1 width=32) (actual time=1019050.478..1019050.478 rows=1 loops=1)
         ->  Gather  (cost=16849614.74..16849614.95 rows=2 width=64) (actual time=1019050.447..1019361.215 rows=3 loops=1)
               Workers Planned: 2
               Workers Launched: 2
               ->  Partial Aggregate  (cost=16848614.74..16848614.75 rows=1 width=64) (actual time=1019035.247..1019035.247 rows=1 loops=3)
                     ->  Parallel Hash Join  (cost=659827.66..16802641.92 rows=2627018 width=33) (actual time=931543.206..1017450.991 rows=2576242 loops=3)
                           Hash Cond: (lineitem.l_partkey = part.p_partkey)
                           ->  Parallel Seq Scan on lineitem  (cost=0.00..16038106.80 rows=3328555 width=20) (actual time=23.938..559418.354 rows=2576242 loops=3)
                                 Filter: ((l_shipdate >= '1994-03-01'::date) AND (l_shipdate < '1994-04-01 00:00:00'::timestamp without time zone))
                                 Rows Removed by Filter: 197436392
                           ->  Parallel Hash  (cost=498706.96..498706.96 rows=8332696 width=25) (actual time=365121.662..365121.663 rows=6666667 loops=3)
                                 Buckets: 65536  Batches: 512  Memory Usage: 2912kB
                                 ->  Parallel Seq Scan on part  (cost=0.00..498706.96 rows=8332696 width=25) (actual time=0.027..358919.237 rows=6666667 loops=3)
 Planning Time: 366.914 ms
 Execution Time: 1019361.536 ms
(16 rows)

COMMIT
query15:
BEGIN
CREATE VIEW
                                                                                      QUERY PLAN                                                                         
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=35403642.82..35403728.94 rows=1 width=103) (actual time=2575159.860..2575227.298 rows=1 loops=1)
   InitPlan 1 (returns $1)
     ->  Aggregate  (cost=17904533.28..17904533.29 rows=1 width=32) (actual time=1623851.912..1623851.913 rows=1 loops=1)
           ->  Finalize GroupAggregate  (cost=17499109.10..17891783.51 rows=1019982 width=40) (actual time=1612043.803..1623689.704 rows=1000000 loops=1)
                 Group Key: lineitem_1.l_suppkey
                 ->  Gather Merge  (cost=17499109.10..17863734.00 rows=2039964 width=40) (actual time=1612043.742..1621646.866 rows=1999979 loops=1)
                       Workers Planned: 2
                       Workers Launched: 1
                       ->  Partial GroupAggregate  (cost=17498109.08..17627271.52 rows=1019982 width=40) (actual time=1611957.057..1621197.979 rows=999990 loops=2)
                             Group Key: lineitem_1.l_suppkey
                             ->  Sort  (cost=17498109.08..17521391.61 rows=9313013 width=20) (actual time=1611956.996..1614150.390 rows=11473844 loops=2)
                                   Sort Key: lineitem_1.l_suppkey
                                   Sort Method: external merge  Disk: 353392kB
                                   Worker 0:  Sort Method: external merge  Disk: 353272kB
                                   ->  Parallel Seq Scan on lineitem lineitem_1  (cost=0.00..16038106.80 rows=9313013 width=20) (actual time=0.028..1556120.269 rows=11473844 loops=2)
                                         Filter: ((l_shipdate >= '1997-05-01'::date) AND (l_shipdate < '1997-08-01 00:00:00'::timestamp without time zone))
                                         Rows Removed by Filter: 288545107
   ->  Nested Loop  (cost=17499109.53..17938346.99 rows=5100 width=103) (actual time=2575159.859..2575159.859 rows=1 loops=1)
         ->  Finalize GroupAggregate  (cost=17499109.10..17907083.24 rows=5100 width=40) (actual time=2575140.012..2575140.013 rows=1 loops=1)
               Group Key: lineitem.l_suppkey
               Filter: (sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount))) = $1)
               Rows Removed by Filter: 587939
               ->  Gather Merge  (cost=17499109.10..17863734.00 rows=2039964 width=40) (actual time=944254.273..949592.160 rows=1762970 loops=1)
                     Workers Planned: 2
                     Workers Launched: 2
                     ->  Partial GroupAggregate  (cost=17498109.08..17627271.52 rows=1019982 width=40) (actual time=943353.098..947972.154 rows=588125 loops=3)
                           Group Key: lineitem.l_suppkey
                           ->  Sort  (cost=17498109.08..17521391.61 rows=9313013 width=20) (actual time=943353.011..944602.389 rows=4501078 loops=3)
                                 Sort Key: lineitem.l_suppkey
                                 Sort Method: external merge  Disk: 235920kB
                                 Worker 0:  Sort Method: external merge  Disk: 234720kB
                                 Worker 1:  Sort Method: external merge  Disk: 236000kB
                                 ->  Parallel Seq Scan on lineitem  (cost=0.00..16038106.80 rows=9313013 width=20) (actual time=3.800..906458.004 rows=7649229 loops=3)
                                       Filter: ((l_shipdate >= '1997-05-01'::date) AND (l_shipdate < '1997-08-01 00:00:00'::timestamp without time zone))
                                       Rows Removed by Filter: 192363405
         ->  Index Scan using supplier_pkey on supplier  (cost=0.42..6.12 rows=1 width=71) (actual time=19.784..19.784 rows=1 loops=1)
               Index Cond: (s_suppkey = lineitem.l_suppkey)
 Planning Time: 105.098 ms
 Execution Time: 2575324.849 ms
(39 rows)

DROP VIEW
COMMIT
query16:
BEGIN
                                                                                        QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=5464876.91..5464876.92 rows=1 width=44) (actual time=806630.901..806631.158 rows=1 loops=1)
   ->  Sort  (cost=5464876.91..5465345.66 rows=187500 width=44) (actual time=806630.898..806630.898 rows=1 loops=1)
         Sort Key: (count(DISTINCT partsupp.ps_suppkey)) DESC, part.p_brand, part.p_type, part.p_size
         Sort Method: top-N heapsort  Memory: 25kB
         ->  GroupAggregate  (cost=5388567.84..5463939.41 rows=187500 width=44) (actual time=796000.310..806618.038 rows=27840 loops=1)
               Group Key: part.p_brand, part.p_type, part.p_size
               ->  Sort  (cost=5388567.84..5403267.15 rows=5879726 width=44) (actual time=795999.676..801947.402 rows=11872637 loops=1)
                     Sort Key: part.p_brand, part.p_type, part.p_size
                     Sort Method: external merge  Disk: 673864kB
                     ->  Hash Join  (cost=1004452.63..4365725.51 rows=5879726 width=44) (actual time=256750.460..733405.853 rows=11872637 loops=1)
                           Hash Cond: (partsupp.ps_partkey = part.p_partkey)
                           ->  Seq Scan on partsupp  (cost=29386.58..2872168.78 rows=39991488 width=16) (actual time=4988.490..223178.402 rows=79961680 loops=1)
                                 Filter: (NOT (hashed SubPlan 1))
                                 Rows Removed by Filter: 38320
                                 SubPlan 1
                                   ->  Gather  (cost=1000.00..29386.33 rows=100 width=4) (actual time=384.038..4988.054 rows=479 loops=1)
                                         Workers Planned: 2
                                         Workers Launched: 2
                                         ->  Parallel Seq Scan on supplier  (cost=0.00..28376.33 rows=42 width=4) (actual time=159.304..4984.850 rows=160 loops=3)
                                               Filter: ((s_comment)::text ~~ '%Customer%Complaints%'::text)
                                               Rows Removed by Filter: 333174
                           ->  Hash  (cost=915341.75..915341.75 rows=2940264 width=40) (actual time=251723.082..251723.082 rows=2969600 loops=1)
                                 Buckets: 65536  Batches: 64  Memory Usage: 3872kB
                                 ->  Seq Scan on part  (cost=0.00..915341.75 rows=2940264 width=40) (actual time=0.022..238045.362 rows=2969600 loops=1)
                                       Filter: ((p_brand <> 'Brand#31'::bpchar) AND ((p_type)::text !~~ 'LARGE PLATED%'::text) AND (p_size = ANY ('{47,31,18,19,48,7,39,22}'::integer[])))
                                       Rows Removed by Filter: 17030400
 Planning Time: 409.533 ms
 Execution Time: 806735.668 ms
(28 rows)

COMMIT
query17:
BEGIN
                                                                                            QUERY PLAN                                                                   
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=88290514.89..88290514.90 rows=1 width=32) (actual time=2683083.064..2683083.689 rows=1 loops=1)
   ->  Aggregate  (cost=88290514.89..88290514.90 rows=1 width=32) (actual time=2683083.060..2683083.060 rows=1 loops=1)
         ->  Hash Join  (cost=72591308.84..88290002.83 rows=204825 width=8) (actual time=2179438.892..2683068.661 rows=54234 loops=1)
               Hash Cond: (part.p_partkey = lineitem_1.l_partkey)
               Join Filter: (lineitem.l_quantity < ((0.2 * avg(lineitem_1.l_quantity))))
               Rows Removed by Join Filter: 547918
               ->  Gather  (cost=541477.10..16034305.05 rows=484965 width=25) (actual time=71761.336..546626.415 rows=602152 loops=1)
                     Workers Planned: 2
                     Workers Launched: 2
                     ->  Parallel Hash Join  (cost=540477.10..15984808.55 rows=202069 width=25) (actual time=71753.771..551128.997 rows=200717 loops=3)
                           Hash Cond: (lineitem.l_partkey = part.p_partkey)
                           ->  Parallel Seq Scan on lineitem  (cost=0.00..14788053.20 rows=250010720 width=21) (actual time=0.024..438008.877 rows=200012634 loops=3)
                           ->  Parallel Hash  (cost=540370.44..540370.44 rows=8533 width=4) (actual time=71750.658..71750.658 rows=6694 loops=3)
                                 Buckets: 32768  Batches: 1  Memory Usage: 1120kB
                                 ->  Parallel Seq Scan on part  (cost=0.00..540370.44 rows=8533 width=4) (actual time=183.191..71741.068 rows=6694 loops=3)
                                       Filter: ((p_brand = 'Brand#13'::bpchar) AND (p_container = 'WRAP PKG'::bpchar))
                                       Rows Removed by Filter: 6659973
               ->  Hash  (cost=71535133.17..71535133.17 rows=25339006 width=40) (actual time=2107383.668..2107383.668 rows=20000000 loops=1)
                     Buckets: 65536  Batches: 512  Memory Usage: 2515kB
                     ->  Finalize GroupAggregate  (cost=62480254.92..71281743.11 rows=25339006 width=40) (actual time=1909250.447..2090122.680 rows=20000000 loops=1)
                           Group Key: lineitem_1.l_partkey
                           ->  Gather Merge  (cost=62480254.92..70521572.93 rows=50678012 width=40) (actual time=1909250.397..2029083.596 rows=59998354 loops=1)
                                 Workers Planned: 2
                                 Workers Launched: 2
                                 ->  Partial GroupAggregate  (cost=62479254.90..64671072.87 rows=25339006 width=40) (actual time=1785599.122..1893972.113 rows=19999451 loops=3)
                                       Group Key: lineitem_1.l_partkey
                                       ->  Sort  (cost=62479254.90..63104281.70 rows=250010720 width=13) (actual time=1785599.058..1828752.796 rows=200012634 loops=3)
                                             Sort Key: lineitem_1.l_partkey
                                             Sort Method: external merge  Disk: 4540008kB
                                             Worker 0:  Sort Method: external merge  Disk: 4479824kB
                                             Worker 1:  Sort Method: external merge  Disk: 4484192kB
                                             ->  Parallel Seq Scan on lineitem lineitem_1  (cost=0.00..14788053.20 rows=250010720 width=13) (actual time=0.016..783640.718 rows=200012634 loops=3)
 Planning Time: 2.746 ms
 Execution Time: 2683411.398 ms
(34 rows)

COMMIT
query18:
BEGIN
                                                                                                        QUERY PLAN                                                       
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=92911878.12..92911878.37 rows=100 width=71) (actual time=5508423.183..5508423.513 rows=100 loops=1)
   ->  Sort  (cost=92911878.12..92913139.85 rows=504693 width=71) (actual time=5508423.181..5508423.188 rows=100 loops=1)
         Sort Key: orders.o_totalprice DESC, orders.o_orderdate
         Sort Method: top-N heapsort  Memory: 38kB
         ->  GroupAggregate  (cost=92881233.52..92892589.12 rows=504693 width=71) (actual time=5508420.432..5508422.476 rows=732 loops=1)
               Group Key: customer.c_custkey, orders.o_orderkey
               ->  Sort  (cost=92881233.52..92882495.26 rows=504693 width=44) (actual time=5508420.380..5508420.700 rows=5124 loops=1)
                     Sort Key: customer.c_custkey, orders.o_orderkey
                     Sort Method: quicksort  Memory: 593kB
                     ->  Hash Join  (cost=66317949.85..92817900.36 rows=504693 width=44) (actual time=4499589.765..5508417.561 rows=5124 loops=1)
                           Hash Cond: (orders.o_custkey = customer.c_custkey)
                           ->  Hash Join  (cost=65519618.41..91923456.10 rows=504693 width=29) (actual time=3400230.336..5366779.604 rows=5124 loops=1)
                                 Hash Cond: (lineitem.l_orderkey = orders.o_orderkey)
                                 ->  Seq Scan on lineitem  (cost=0.00..18288203.28 rows=600025728 width=13) (actual time=0.058..1436280.328 rows=600037902 loops=1)
                                 ->  Hash  (cost=65517178.47..65517178.47 rows=126155 width=32) (actual time=3369872.545..3369872.545 rows=732 loops=1)
                                       Buckets: 65536  Batches: 4  Memory Usage: 525kB
                                       ->  Nested Loop  (cost=62480255.49..65517178.47 rows=126155 width=32) (actual time=1738955.623..3367134.259 rows=732 loops=1)
                                             ->  Finalize GroupAggregate  (cost=62480254.92..64458788.86 rows=126155 width=8) (actual time=1735568.643..3250535.455 rows=732 loops=1)
                                                   Group Key: lineitem_1.l_orderkey
                                                   Filter: (sum(lineitem_1.l_quantity) > '314'::numeric)
                                                   Rows Removed by Filter: 149999268
                                                   ->  Gather Merge  (cost=62480254.92..64447434.88 rows=756932 width=40) (actual time=1732816.240..3080184.855 rows=158537367 loops=1)
                                                         Workers Planned: 2
                                                         Workers Launched: 2
                                                         ->  Partial GroupAggregate  (cost=62479254.90..64359066.12 rows=378466 width=40) (actual time=1651590.640..2223775.303 rows=52845789 loops=3)
                                                               Group Key: lineitem_1.l_orderkey
                                                               ->  Sort  (cost=62479254.90..63104281.70 rows=250010720 width=13) (actual time=1651590.585..2128782.845 rows=200012634 loops=3)
                                                                     Sort Key: lineitem_1.l_orderkey
                                                                     Sort Method: external merge  Disk: 4500200kB
                                                                     Worker 0:  Sort Method: external merge  Disk: 4499784kB
                                                                     Worker 1:  Sort Method: external merge  Disk: 4504024kB
                                                                     ->  Parallel Seq Scan on lineitem lineitem_1  (cost=0.00..14788053.20 rows=250010720 width=13) (actual time=0.135..540421.616 rows=200012634 loops=3)
                                             ->  Index Scan using orders_pkey on orders  (cost=0.57..8.38 rows=1 width=24) (actual time=159.277..159.277 rows=1 loops=732)
                                                   Index Cond: (o_orderkey = lineitem_1.l_orderkey)
                           ->  Hash  (cost=522957.42..522957.42 rows=14999042 width=23) (actual time=17689.559..17689.559 rows=15000000 loops=1)
                                 Buckets: 65536  Batches: 256  Memory Usage: 3717kB
                                 ->  Seq Scan on customer  (cost=0.00..522957.42 rows=14999042 width=23) (actual time=15.942..13090.581 rows=15000000 loops=1)
 Planning Time: 114.339 ms
 Execution Time: 5508642.472 ms
(39 rows)

COMMIT
query19:
BEGIN


                              QUERY PLAN                                                                                                                                                                                                                                                                                                         
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=20571315.41..20571315.42 rows=1 width=32) (actual time=2909104.406..2909206.837 rows=1 loops=1)
   ->  Finalize Aggregate  (cost=20571315.41..20571315.42 rows=1 width=32) (actual time=2909104.403..2909104.404 rows=1 loops=1)
         ->  Gather  (cost=20571315.19..20571315.40 rows=2 width=32) (actual time=2909104.084..2909206.788 rows=3 loops=1)
               Workers Planned: 2
               Workers Launched: 2
               ->  Partial Aggregate  (cost=20570315.19..20570315.20 rows=1 width=32) (actual time=2909098.222..2909098.222 rows=1 loops=3)
                     ->  Parallel Hash Join  (cost=769768.55..20570287.56 rows=3684 width=12) (actual time=63851.140..2909074.553 rows=3760 loops=3)
                           Hash Cond: (lineitem.l_partkey = part.p_partkey)
                           Join Filter: (((part.p_brand = 'Brand#54'::bpchar) AND (part.p_container = ANY ('{"SM CASE","SM BOX","SM PACK","SM PKG"}'::bpchar[])) AND (lineitem.l_quantity >= '8'::numeric) AND (lineitem.l_quantity <= '18'::numeric) AND (part.p_size <= 5)) OR ((part.p_brand = 'Brand#22'::bpchar) AND (part.p_container = ANY ('{"MED BAG","MED BOX","MED PKG","MED PACK"}'::bpchar[])) AND (lineitem.l_quantity >= '13'::numeric) AND (lineitem.l_quantity <= '23'::numeric) AND (part.p_size <= 10)) OR ((part.p_brand = 'Brand#51'::bpchar) AND (part.p_container = ANY ('{"LG CASE","LG BOX","LG PACK","LG PKG"}'::bpchar[])) AND (lineitem.l_quantity >= '22'::numeric) AND (lineitem.l_quantity <= '32'::numeric) AND (part.p_size <= 15)))
                           Rows Removed by Join Filter: 4774
                           ->  Parallel Seq Scan on lineitem  (cost=0.00..19788267.60 rows=4667203 width=25) (actual time=2.833..2842547.123 rows=3572175 loops=3)
                                 Filter: ((l_shipmode = ANY ('{AIR,"AIR REG"}'::bpchar[])) AND (l_shipinstruct = 'DELIVER IN PERSON'::bpchar) AND (((l_quantity >= '8'::numeric) AND (l_quantity <= '18'::numeric)) OR ((l_quantity >= '13'::numeric) AND (l_quantity <= '23'::numeric)) OR ((l_quantity >= '22'::numeric) AND (l_quantity <= '32'::numeric))))
                                 Rows Removed by Filter: 196440459
                           ->  Parallel Hash  (cost=769519.57..769519.57 rows=19918 width=30) (actual time=63502.063..63502.064 rows=16054 loops=3)
                                 Buckets: 65536  Batches: 1  Memory Usage: 3584kB
                                 ->  Parallel Seq Scan on part  (cost=0.00..769519.57 rows=19918 width=30) (actual time=428.148..63474.604 rows=16054 loops=3)
                                       Filter: ((p_size >= 1) AND (((p_brand = 'Brand#54'::bpchar) AND (p_container = ANY ('{"SM CASE","SM BOX","SM PACK","SM PKG"}'::bpchar[])) AND (p_size <= 5)) OR ((p_brand = 'Brand#22'::bpchar) AND (p_container = ANY ('{"MED BAG","MED BOX","MED PKG","MED PACK"}'::bpchar[])) AND (p_size <= 10)) OR ((p_brand = 'Brand#51'::bpchar) AND (p_container = ANY ('{"LG CASE","LG BOX","LG PACK","LG PKG"}'::bpchar[])) AND (p_size <= 15))))
                                       Rows Removed by Filter: 6650612
 Planning Time: 3.299 ms
 Execution Time: 2909207.105 ms
(20 rows)

COMMIT
query20:
BEGIN
                                                                                         QUERY PLAN                                                                      
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=37855546.34..37855546.35 rows=1 width=51) (actual time=7740450.725..7740452.906 rows=1 loops=1)
   ->  Sort  (cost=37855546.34..37855546.35 rows=1 width=51) (actual time=7740450.723..7740450.723 rows=1 loops=1)
         Sort Key: supplier.s_name
         Sort Method: top-N heapsort  Memory: 25kB
         ->  Nested Loop Semi Join  (cost=26064049.64..37855546.33 rows=1 width=51) (actual time=4314923.353..7740344.963 rows=17885 loops=1)
               Join Filter: (supplier.s_suppkey = lineitem.l_suppkey)
               Rows Removed by Join Filter: 17882422699
               ->  Gather  (cost=1012.14..30056.02 rows=5882 width=55) (actual time=21.360..92.196 rows=40105 loops=1)
                     Workers Planned: 2
                     Workers Launched: 2
                     ->  Hash Join  (cost=12.14..28467.82 rows=2451 width=55) (actual time=16.980..5764.974 rows=13368 loops=3)
                           Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                           ->  Parallel Seq Scan on supplier  (cost=0.00..27334.67 rows=416667 width=63) (actual time=15.341..5725.037 rows=333333 loops=3)
                           ->  Hash  (cost=12.12..12.12 rows=1 width=4) (actual time=1.400..1.401 rows=1 loops=3)
                                 Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                 ->  Seq Scan on nation  (cost=0.00..12.12 rows=1 width=4) (actual time=1.382..1.387 rows=1 loops=3)
                                       Filter: (n_name = 'INDIA'::bpchar)
                                       Rows Removed by Filter: 24
               ->  Materialize  (cost=26063037.50..37822931.71 rows=29 width=16) (actual time=101.028..154.826 rows=445891 loops=40105)
                     ->  Merge Join  (cost=26063037.50..37822931.57 rows=29 width=16) (actual time=4051537.625..4316197.534 rows=591557 loops=1)
                           Merge Cond: ((lineitem.l_partkey = partsupp.ps_partkey) AND (lineitem.l_suppkey = partsupp.ps_suppkey))
                           Join Filter: ((partsupp.ps_availqty)::numeric > ((0.5 * sum(lineitem.l_quantity))))
                           Rows Removed by Join Filter: 1197
                           ->  Finalize GroupAggregate  (cost=23101076.43..34128468.66 rows=48294763 width=48) (actual time=3597552.371..3837013.045 rows=54543085 loops=1)
                                 Group Key: lineitem.l_partkey, lineitem.l_suppkey
                                 ->  Gather Merge  (cost=23101076.43..32650216.23 rows=75383098 width=48) (actual time=3597552.336..3751396.825 rows=69575348 loops=1)
                                       Workers Planned: 2
                                       Workers Launched: 1
                                       ->  Partial GroupAggregate  (cost=23100076.40..23948136.26 rows=37691549 width=48) (actual time=3558894.795..3657343.999 rows=34787940 loops=2)
                                             Group Key: lineitem.l_partkey, lineitem.l_suppkey
                                             ->  Sort  (cost=23100076.40..23194305.28 rows=37691549 width=21) (actual time=3558894.735..3615652.983 rows=45514976 loops=2)
                                                   Sort Key: lineitem.l_partkey, lineitem.l_suppkey
                                                   Sort Method: external merge  Disk: 1380008kB
                                                   Worker 0:  Sort Method: external merge  Disk: 1381320kB
                                                   ->  Parallel Seq Scan on lineitem  (cost=0.00..16038106.80 rows=37691549 width=21) (actual time=2.390..3275252.370 rows=45515329 loops=2)
                                                         Filter: ((l_shipdate >= '1994-01-01'::date) AND (l_shipdate < '1995-01-01 00:00:00'::timestamp without time zone))
                                                         Rows Removed by Filter: 254503622
                           ->  Materialize  (cost=2961961.08..2966000.63 rows=807910 width=24) (actual time=453984.797..472651.169 rows=870364 loops=1)
                                 ->  Sort  (cost=2961961.08..2963980.85 rows=807910 width=24) (actual time=453984.783..472518.822 rows=870364 loops=1)
                                       Sort Key: partsupp.ps_partkey, partsupp.ps_suppkey
                                       Sort Method: external merge  Disk: 28976kB
                                       ->  Gather  (cost=521590.81..2866120.61 rows=807910 width=24) (actual time=98131.129..446197.530 rows=870364 loops=1)
                                             Workers Planned: 2
                                             Workers Launched: 2
                                             ->  Parallel Hash Join  (cost=520590.81..2784329.61 rows=336629 width=24) (actual time=94393.542..442663.840 rows=290121 loops=3)
                                                   Hash Cond: (partsupp.ps_partkey = part.p_partkey)
                                                   ->  Parallel Seq Scan on partsupp  (cost=0.00..2176257.40 rows=33326240 width=20) (actual time=52.102..342367.176 rows=26666667 loops=3)
                                                   ->  Parallel Hash  (cost=519538.70..519538.70 rows=84169 width=4) (actual time=94033.010..94033.011 rows=72530 loops=3)
                                                         Buckets: 262144  Batches: 1  Memory Usage: 10592kB
                                                         ->  Parallel Seq Scan on part  (cost=0.00..519538.70 rows=84169 width=4) (actual time=91.126..93952.401 rows=72530 loops=3)
                                                               Filter: ((p_name)::text ~~ 'navajo%'::text)
                                                               Rows Removed by Filter: 6594136
 Planning Time: 417.737 ms
 Execution Time: 7740669.701 ms
(54 rows)

COMMIT
query21:
BEGIN
                                                                                           QUERY PLAN                                                                    
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=21269551.67..21269551.67 rows=1 width=34) (actual time=5239620.889..5239621.991 rows=100 loops=1)
   ->  Sort  (cost=21269551.67..21269551.67 rows=1 width=34) (actual time=5239620.887..5239620.893 rows=100 loops=1)
         Sort Key: (count(*)) DESC, supplier.s_name
         Sort Method: top-N heapsort  Memory: 37kB
         ->  GroupAggregate  (cost=21269551.64..21269551.66 rows=1 width=34) (actual time=5238861.942..5239608.790 rows=40104 loops=1)
               Group Key: supplier.s_name
               ->  Sort  (cost=21269551.64..21269551.64 rows=1 width=26) (actual time=5238861.891..5239534.712 rows=396845 loops=1)
                     Sort Key: supplier.s_name
                     Sort Method: external merge  Disk: 14032kB
                     ->  Nested Loop  (cost=29500.18..21269551.63 rows=1 width=26) (actual time=24985.876..5234991.471 rows=396845 loops=1)
                           ->  Nested Loop Semi Join  (cost=29499.61..21269543.14 rows=1 width=42) (actual time=24883.407..2354192.254 rows=807366 loops=1)
                                 ->  Gather  (cost=29499.03..21266670.76 rows=1 width=42) (actual time=24882.665..2348385.968 rows=1350544 loops=1)
                                       Workers Planned: 2
                                       Workers Launched: 0
                                       ->  Nested Loop Anti Join  (cost=28499.03..21265670.66 rows=1 width=42) (actual time=24882.140..2347863.452 rows=1350544 loops=1)
                                             ->  Parallel Hash Join  (cost=28498.46..15756094.43 rows=480613 width=42) (actual time=24772.547..1419974.777 rows=15209365 loops=1)
                                                   Hash Cond: (l1.l_suppkey = supplier.s_suppkey)
                                                   ->  Parallel Seq Scan on lineitem l1  (cost=0.00..15413080.00 rows=83336907 width=16) (actual time=0.020..1295397.265 rows=379356474 loops=1)
                                                         Filter: (l_receiptdate > l_commitdate)
                                                         Rows Removed by Filter: 220681428
                                                   ->  Parallel Hash  (cost=28467.82..28467.82 rows=2451 width=30) (actual time=24772.236..24772.237 rows=40105 loops=1)
                                                         Buckets: 65536 (originally 8192)  Batches: 1 (originally 1)  Memory Usage: 3488kB
                                                         ->  Hash Join  (cost=12.14..28467.82 rows=2451 width=30) (actual time=0.070..24748.770 rows=40105 loops=1)
                                                               Hash Cond: (supplier.s_nationkey = nation.n_nationkey)
                                                               ->  Parallel Seq Scan on supplier  (cost=0.00..27334.67 rows=416667 width=38) (actual time=0.025..24629.429 rows=1000000 loops=1)
                                                               ->  Hash  (cost=12.12..12.12 rows=1 width=4) (actual time=0.026..0.026 rows=1 loops=1)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 9kB
                                                                     ->  Seq Scan on nation  (cost=0.00..12.12 rows=1 width=4) (actual time=0.015..0.018 rows=1 loops=1)
                                                                           Filter: (n_name = 'INDIA'::bpchar)
                                                                           Rows Removed by Filter: 24
                                             ->  Index Scan using lineitem_pkey on lineitem l3  (cost=0.57..2876.33 rows=528 width=16) (actual time=0.060..0.060 rows=1 loops=15209365)
                                                   Index Cond: (l_orderkey = l1.l_orderkey)
                                                   Filter: ((l_receiptdate > l_commitdate) AND (l_suppkey <> l1.l_suppkey))
                                                   Rows Removed by Filter: 1
                                 ->  Index Scan using lineitem_pkey on lineitem l2  (cost=0.57..2872.37 rows=1585 width=16) (actual time=0.003..0.003 rows=1 loops=1350544)
                                       Index Cond: (l_orderkey = l1.l_orderkey)
                                       Filter: (l_suppkey <> l1.l_suppkey)
                                       Rows Removed by Filter: 1
                           ->  Index Scan using orders_pkey on orders  (cost=0.57..8.49 rows=1 width=4) (actual time=3.567..3.567 rows=0 loops=807366)
                                 Index Cond: (o_orderkey = l1.l_orderkey)
                                 Filter: (o_orderstatus = 'F'::bpchar)
                                 Rows Removed by Filter: 1
 Planning Time: 1955.659 ms
 Execution Time: 5239624.176 ms
(44 rows)

COMMIT
query22:
BEGIN
                                                                                   QUERY PLAN                                                                            
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=5769131.51..5769131.64 rows=1 width=72) (actual time=2847775.287..2848262.837 rows=1 loops=1)
   InitPlan 1 (returns $1)
     ->  Finalize Aggregate  (cost=538517.16..538517.17 rows=1 width=32) (actual time=535054.812..535054.812 rows=1 loops=1)
           ->  Gather  (cost=538516.93..538517.14 rows=2 width=32) (actual time=535054.782..535054.836 rows=1 loops=1)
                 Workers Planned: 2
                 Workers Launched: 0
                 ->  Partial Aggregate  (cost=537516.93..537516.94 rows=1 width=32) (actual time=535054.397..535054.397 rows=1 loops=1)
                       ->  Parallel Seq Scan on customer customer_1  (cost=0.00..537019.02 rows=199164 width=6) (actual time=112.101..534580.067 rows=2181431 loops=1)
                             Filter: ((c_acctbal > 0.00) AND ("substring"((c_phone)::text, 1, 2) = ANY ('{28,43,22,39,31,30,41}'::text[])))
                             Rows Removed by Filter: 12818569
   ->  Finalize GroupAggregate  (cost=5230614.34..5241250.26 rows=79682 width=72) (actual time=2847775.284..2847775.284 rows=1 loops=1)
         Group Key: ("substring"((customer.c_phone)::text, 1, 2))
         ->  Gather Merge  (cost=5230614.34..5239191.81 rows=66402 width=72) (actual time=2847732.255..2848262.585 rows=2 loops=1)
               Workers Planned: 2
               Params Evaluated: $1
               Workers Launched: 0
               ->  Partial GroupAggregate  (cost=5229614.32..5230527.35 rows=33201 width=72) (actual time=2312676.517..2312719.514 rows=2 loops=1)
                     Group Key: ("substring"((customer.c_phone)::text, 1, 2))
                     ->  Sort  (cost=5229614.32..5229697.32 rows=33201 width=38) (actual time=2312636.483..2312674.983 rows=181334 loops=1)
                           Sort Key: ("substring"((customer.c_phone)::text, 1, 2))
                           Sort Method: external merge  Disk: 7120kB
                           ->  Parallel Hash Anti Join  (cost=4444005.80..5227121.10 rows=33201 width=38) (actual time=1266323.651..2311993.551 rows=363245 loops=1)
                                 Hash Cond: (customer.c_custkey = orders.o_custkey)
                                 ->  Parallel Seq Scan on customer  (cost=0.00..537019.02 rows=72912 width=26) (actual time=84.443..135716.876 rows=1090325 loops=1)
                                       Filter: ((c_acctbal > $1) AND ("substring"((c_phone)::text, 1, 2) = ANY ('{28,43,22,39,31,30,41}'::text[])))
                                       Rows Removed by Filter: 13909675
                                 ->  Parallel Hash  (cost=3418718.80..3418718.80 rows=62493680 width=8) (actual time=1127825.996..1127825.997 rows=150000000 loops=1)
                                       Buckets: 131072  Batches: 2048  Memory Usage: 4064kB
                                       ->  Parallel Seq Scan on orders  (cost=0.00..3418718.80 rows=62493680 width=8) (actual time=124.692..1017221.606 rows=150000000 loops=1)
 Planning Time: 63.155 ms
 Execution Time: 2848264.578 ms
(31 rows)

COMMIT


